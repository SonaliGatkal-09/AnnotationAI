"use strict";(self.webpackChunkanotate_shell=self.webpackChunkanotate_shell||[]).push([[5391],{3017:(e,t,s)=>{function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)({}).hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},l.apply(null,arguments)}s.d(t,{A:()=>l})},5391:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x});var l=s(4146),a=s(4999),n=s(2712),i=s(3017),c=s(2540);const r=({imageSrc:e,boxes:t=[],onBoxChange:s,editable:r=!0,className:o})=>{const d=(0,l.useRef)(null),h=(0,l.useRef)(null),[x,u]=(0,l.useState)(null),[m,g]=(0,l.useState)(!1),[j,p]=(0,l.useState)({width:0,height:0}),[b,f]=(0,l.useState)(!1),[v,y]=(0,l.useState)({x:0,y:0});(0,l.useEffect)((()=>{h.current&&h.current.complete&&(g(!0),p({width:h.current.width,height:h.current.height}))}),[]);const N=e=>{r&&u(x===e?null:e)},w=()=>{const e=["#9b87f5","#7E69AB","#6E59A5","#D6BCFA","#E5DEFF"];return e[Math.floor(Math.random()*e.length)]};return(0,c.jsx)("div",{className:(0,n.cn)("annotation-canvas",o),children:(0,c.jsxs)("div",{ref:d,className:"relative overflow-hidden",onMouseDown:e=>{if(!r||!d.current)return;const s=d.current.getBoundingClientRect(),l=e.clientX-s.left,a=e.clientY-s.top,n=(t||[]).find((e=>{const t=e.x*j.width,s=e.y*j.height,n=e.width*j.width,i=e.height*j.height;return l>=t&&l<=t+n&&a>=s&&a<=s+i}));n?N(n.id):(f(!0),y({x:l,y:a}))},onMouseMove:e=>{if(!b||!d.current||!r)return;const t=d.current.getBoundingClientRect(),s=Math.max(0,Math.min(e.clientX-t.left,j.width)),l=Math.max(0,Math.min(e.clientY-t.top,j.height)),a=document.getElementById("temp-box");if(a){const e=s-v.x,t=l-v.y;e>0&&t>0?(a.style.left=`${v.x}px`,a.style.top=`${v.y}px`,a.style.width=`${e}px`,a.style.height=`${t}px`,a.style.display="block"):e<0&&t>0?(a.style.left=`${s}px`,a.style.top=`${v.y}px`,a.style.width=`${Math.abs(e)}px`,a.style.height=`${t}px`,a.style.display="block"):e>0&&t<0?(a.style.left=`${v.x}px`,a.style.top=`${l}px`,a.style.width=`${e}px`,a.style.height=`${Math.abs(t)}px`,a.style.display="block"):(a.style.left=`${s}px`,a.style.top=`${l}px`,a.style.width=`${Math.abs(e)}px`,a.style.height=`${Math.abs(t)}px`,a.style.display="block")}},onMouseUp:e=>{if(!b||!d.current||!r)return;const l=d.current.getBoundingClientRect(),a=Math.max(0,Math.min(e.clientX-l.left,j.width)),n=Math.max(0,Math.min(e.clientY-l.top,j.height)),i=Math.abs(a-v.x),c=Math.abs(n-v.y);if(i>10&&c>10){const e=Math.min(v.x,a)/j.width,l=Math.min(v.y,n)/j.height,r=i/j.width,o=c/j.height,d={id:`box-${Date.now()}`,x:e,y:l,width:r,height:o,label:"unlabeled",color:w()},h=[...t||[],d];s&&s(h),u(d.id)}const o=document.getElementById("temp-box");o&&(o.style.display="none"),f(!1)},onMouseLeave:()=>f(!1),children:[(0,c.jsx)("img",{ref:h,src:e,alt:"Annotation canvas",className:"max-w-full h-auto",onLoad:()=>{g(!0),h.current&&p({width:h.current.width,height:h.current.height})}}),(0,c.jsx)("div",{id:"temp-box",className:"absolute border-2 border-dashed border-studio-purple bg-studio-purple/20 pointer-events-none",style:{display:"none"}}),m&&(t||[]).map((e=>{const l={left:e.x*j.width+"px",top:e.y*j.height+"px",width:e.width*j.width+"px",height:e.height*j.height+"px",borderColor:e.color,backgroundColor:`${e.color}20`},o=x===e.id;return(0,c.jsx)("div",{className:"absolute border-2 cursor-pointer transition-all "+(o?"border-white shadow-lg":""),style:l,onClick:()=>N(e.id),children:(0,c.jsx)("div",{className:"absolute -top-7 left-0 bg-black/70 text-white text-xs px-2 py-1 rounded-t-md whitespace-nowrap flex items-center gap-1 "+(o?"bg-studio-purple":""),children:o&&r?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("input",{type:"text",value:e.label,onChange:l=>((e,l)=>{const a=(t||[]).map((t=>t.id===e?(0,i.A)({},t,{label:l}):t));s&&s(a)})(e.id,l.target.value),className:"bg-transparent outline-none text-white w-24",onClick:e=>e.stopPropagation()}),(0,c.jsx)(n.Button,{size:"icon",variant:"ghost",className:"h-4 w-4 text-white hover:text-white",onClick:l=>((e,l)=>{l.stopPropagation();const a=(t||[]).filter((t=>t.id!==e));s&&s(a),x===e&&u(null)})(e.id,l),children:(0,c.jsx)(a.X,{className:"h-3 w-3"})})]}):(0,c.jsxs)(c.Fragment,{children:[e.label,void 0!==e.confidence&&(0,c.jsxs)("span",{className:"ml-1 text-gray-300",children:["(",Math.round(100*e.confidence),"%)"]})]})})},e.id)}))]})})},o=[{value:"yolov8s",label:"YOLOv8 Small",category:"Object Detection"},{value:"yolov8m",label:"YOLOv8 Medium",category:"Object Detection"},{value:"yolov8l",label:"YOLOv8 Large",category:"Object Detection"},{value:"yolov8x",label:"YOLOv8 XLarge",category:"Object Detection"},{value:"detr",label:"DETR ResNet-50",category:"Object Detection"},{value:"faster-rcnn",label:"Faster R-CNN",category:"Object Detection"}],d=[{id:"box-1",x:.2,y:.3,width:.4,height:.3,label:"person",confidence:.92,color:"#9b87f5"},{id:"box-2",x:.6,y:.5,width:.3,height:.2,label:"car",confidence:.87,color:"#7E69AB"}],h=()=>{const[e,t]=(0,l.useState)(null),[s,i]=(0,l.useState)("yolov8s"),[h,x]=(0,l.useState)(!1),[u,m]=(0,l.useState)([]),[g,j]=(0,l.useState)("detect"),p=()=>{m([])};return(0,c.jsx)("div",{className:"w-full",children:(0,c.jsxs)(n.Card,{className:"mb-6",children:[(0,c.jsxs)(n.CardHeader,{children:[(0,c.jsx)(n.CardTitle,{className:"text-xl",children:"Object Detection and Annotation"}),(0,c.jsx)(n.CardDescription,{children:"Detect objects in images and create annotations with SOTA models"})]}),(0,c.jsx)(n.CardContent,{children:(0,c.jsxs)(n.Tabs,{value:g,onValueChange:j,className:"w-full",children:[(0,c.jsxs)(n.TabsList,{className:"grid grid-cols-2 w-[300px] mb-6",children:[(0,c.jsx)(n.TabsTrigger,{value:"detect",children:"Detect Objects"}),(0,c.jsx)(n.TabsTrigger,{value:"annotate",children:"Manual Annotation"})]}),(0,c.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsx)("label",{htmlFor:"detection-image-upload",className:"flex flex-col items-center justify-center h-60 border-2 border-dashed rounded-lg cursor-pointer "+(e?"border-muted":"border-muted-foreground/25"),children:e?(0,c.jsxs)("div",{className:"relative w-full h-full",children:[(0,c.jsx)("img",{src:e,alt:"Uploaded image",className:"w-full h-full object-contain"}),(0,c.jsx)(n.Button,{variant:"outline",className:"absolute bottom-2 right-2",onClick:e=>{e.preventDefault(),t(null),m([])},size:"sm",children:"Replace"})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 text-center p-6",children:[(0,c.jsx)("div",{className:"rounded-full bg-muted p-2",children:(0,c.jsx)(a.Upload,{className:"h-5 w-5 text-muted-foreground"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"font-medium",children:"Click to upload an image"}),(0,c.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"JPG, PNG or WEBP"})]})]}),(0,c.jsx)("input",{id:"detection-image-upload",type:"file",accept:"image/*",className:"sr-only",onChange:e=>{var s;const l=null==(s=e.target.files)?void 0:s[0];if(l){const e=new FileReader;e.onload=e=>{var s;const l=null==(s=e.target)?void 0:s.result;t(l),m([])},e.readAsDataURL(l)}}})]})})}),e&&(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"space-y-4",children:["detect"===g&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(n.ModelSelector,{options:o,value:s,onValueChange:i}),(0,c.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:"Select a model for object detection"})]}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)(n.Button,{variant:"default",className:"flex-1",disabled:h||!e,onClick:()=>{e&&(x(!0),setTimeout((()=>{m(d||[]),x(!1)}),2e3))},children:h?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a.RefreshCw,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a.Box,{className:"mr-2 h-4 w-4"}),"Detect Objects"]})}),(0,c.jsx)(n.Button,{variant:"outline",disabled:0===u.length,onClick:p,children:(0,c.jsx)(a.Trash2,{className:"h-4 w-4"})})]})]}),"annotate"===g&&(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsx)("div",{className:"flex justify-between items-center",children:(0,c.jsx)("p",{className:"text-sm",children:"Draw bounding boxes directly on the image"})}),(0,c.jsx)("div",{className:"flex flex-wrap gap-2",children:(["#9b87f5","#7E69AB","#6E59A5","#D6BCFA","#E5DEFF"]||[]).map(((e,t)=>(0,c.jsx)("div",{className:"w-8 h-8 rounded-full border cursor-pointer",style:{backgroundColor:e}},t)))}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsxs)(n.Button,{variant:"default",className:"flex-1",children:[(0,c.jsx)(a.Save,{className:"mr-2 h-4 w-4"}),"Save Annotations"]}),(0,c.jsx)(n.Button,{variant:"outline",disabled:0===u.length,onClick:p,children:(0,c.jsx)(a.Trash2,{className:"h-4 w-4"})})]})]})]})})]}),(0,c.jsx)("div",{className:"flex-1",children:e?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"mb-3 flex justify-between",children:[(0,c.jsx)("h3",{className:"text-md font-medium",children:"detect"===g?"Detection Results":"Manual Annotation"}),(0,c.jsxs)(n.Badge,{variant:"outline",children:[u.length," ",1===u.length?"object":"objects"]})]}),(0,c.jsx)(r,{imageSrc:e,boxes:u,onBoxChange:e=>{m(e||[])},editable:!0}),u.length>0&&(0,c.jsxs)("div",{className:"mt-4",children:[(0,c.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Detected Objects"}),(0,c.jsx)("div",{className:"space-y-2",children:(u||[]).map((e=>(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,c.jsx)("span",{className:"font-medium",children:e.label}),void 0!==e.confidence&&(0,c.jsxs)("span",{className:"text-xs text-muted-foreground",children:[Math.round(100*e.confidence),"% confidence"]})]}),(0,c.jsx)(n.Button,{size:"icon",variant:"ghost",className:"h-8 w-8",children:(0,c.jsx)(a.Eye,{className:"h-4 w-4"})})]},e.id)))})]})]}):(0,c.jsx)("div",{className:"border rounded-lg h-full flex items-center justify-center p-6 text-center",children:(0,c.jsxs)("div",{className:"max-w-xs",children:[(0,c.jsx)(a.Box,{className:"h-8 w-8 mx-auto text-muted-foreground mb-3"}),(0,c.jsx)("h3",{className:"text-lg font-medium mb-1",children:"No image selected"}),(0,c.jsx)("p",{className:"text-sm text-muted-foreground",children:"Upload an image to detect objects or create annotations"})]})})})]})]})})]})})};const x=function(){return(0,c.jsx)("div",{children:(0,c.jsx)(h,{})})}}}]);